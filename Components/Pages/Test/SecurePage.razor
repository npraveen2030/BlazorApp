@page "/secure"
@rendermode InteractiveServer
@inject NavigationManager Navigation
@inject BLazorApp.Services.UserSessionService SessionService

<h3>Secure Page</h3>

    <p>Welcome, @SessionService.UserName</p>
    <button class="btn btn-danger" @onclick="Logout">Logout</button>

@code {

    protected override void OnInitialized()
    {
        if (!SessionService.IsInitialized)
        {
            return; // Skip until initialized
        }

        if (!SessionService.IsAuthenticated)
        {
            Navigation.NavigateTo("/Login");
            return;
        }
    }

    private void Logout()
    {
        SessionService.Logout();
        Navigation.NavigateTo("/Login");
    }
}